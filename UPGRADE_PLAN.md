# SupportSpark - Dependency Upgrade Plan

**Date:** January 5, 2026
**Generated by:** npm-check-updates analysis

## Overview

This document outlines a phased approach to updating dependencies in the SupportSpark application. Updates are grouped by risk level and interdependencies to minimize disruption and allow for thorough testing at each stage.

---

## Updates Summary

### Major Version Updates (Breaking Changes Expected)

- `express`: 4.22.1 ‚Üí 5.2.1
- `@hookform/resolvers`: 3.10.0 ‚Üí 5.2.2
- `date-fns`: 3.6.0 ‚Üí 4.1.0
- `@types/express`: 4.17.25 ‚Üí 5.0.6
- `@types/node`: 20.19.27 ‚Üí 25.0.3
- `@vitejs/plugin-react`: 4.7.0 ‚Üí 5.1.2
- `framer-motion`: 11.18.2 ‚Üí 12.23.28
- `react-resizable-panels`: 2.1.9 ‚Üí 4.2.1
- `recharts`: 2.15.4 ‚Üí 3.6.0
- `tailwind-merge`: 2.6.0 ‚Üí 3.4.0
- `tailwindcss`: 3.4.19 ‚Üí 4.1.18
- `zod`: 3.25.76 ‚Üí 4.3.5

---

## üîµ Phase 1: Low-Risk Updates (Week 1) ‚úÖ COMPLETED

**Goal:** Update packages with minimal breaking changes and good backward compatibility

### Packages to Update

1. **framer-motion** (11.18.2 ‚Üí 12.23.28) ‚ö†Ô∏è **DEFERRED to Phase 3+**
   - Risk: Medium-High (v12 has breaking API changes)
   - Status: Kept at v11.18.2 - v12 requires major refactoring
   - Notes: v12 changes animation prop types significantly, needs migration plan
2. **tailwind-merge** (2.6.0 ‚Üí 3.4.0) ‚úÖ **UPDATED**
   - Risk: Low
   - Status: Successfully updated to v3.4.0
   - Notes: No breaking changes detected

3. **@types/node** (20.19.27 ‚Üí 25.0.3) ‚úÖ **UPDATED**
   - Risk: Low
   - Status: Successfully updated to v25.0.3
   - Notes: Type definitions only, no issues found

### Testing Checklist

- [x] Run `npm install` after updates
- [x] Check TypeScript compilation: `npm run check`
- [x] Test all animation components (cards, dialogs, transitions)
- [x] Verify no console warnings in dev mode
- [x] Run build: `npm run build`

### Rollback Plan

```bash
# If issues arise:
git checkout package.json package-lock.json
npm install
```

---

## üü° Phase 2: React Ecosystem Updates (Week 2) ‚úÖ COMPLETED

**Goal:** Update React-related dependencies and UI components

### Packages to Update

1. **@vitejs/plugin-react** (4.7.0 ‚Üí 5.1.2) ‚úÖ **UPDATED**
   - Risk: Medium
   - Status: Successfully updated to v5.1.2
   - Notes: No vite.config changes required, HMR working
   - **Action Items:**
     - ‚úÖ Review [vite.config.ts](vite.config.ts) for deprecated options
     - ‚úÖ Check HMR (Hot Module Replacement) functionality

2. **react-resizable-panels** (2.1.9 ‚Üí 4.2.1) ‚úÖ **UPDATED**
   - Risk: Medium
   - Status: Successfully updated to v4.2.1
   - Notes: API changed from `PanelGroup/PanelResizeHandle` to `Group/Separator`
   - **Breaking Changes Fixed:**
     - Updated [client/src/components/ui/resizable.tsx](client/src/components/ui/resizable.tsx)
     - Changed imports from namespace to named exports
     - Replaced `PanelGroup` ‚Üí `Group`
     - Replaced `PanelResizeHandle` ‚Üí `Separator`
   - **Action Items:**
     - ‚úÖ Test resizable layouts in conversation view
     - ‚úÖ Verify panel collapse/expand behavior

### Testing Checklist

- [x] Verify HMR works correctly in dev mode
- [x] Test all pages that use resizable panels
- [x] Check conversation view layout responsiveness
- [x] Test component hot reloading
- [x] Build and test production bundle

### Dependencies

- Requires Phase 1 completion
- React 19.2.3 is already at latest (no update needed)

---

## üü† Phase 3: Build Tooling & Styling (Week 3)

**Goal:** Update build tools and styling frameworks

### Packages to Update

1. **tailwindcss** (3.4.19 ‚Üí 4.1.18) ‚ö†Ô∏è **CRITICAL UPDATE**
   - Risk: High
   - Notes: Major version with significant changes
   - **Action Items:**
     - Review [Tailwind v4 migration guide](https://tailwindcss.com/docs/upgrade-guide)
     - Update [tailwind.config.ts](tailwind.config.ts) to v4 format
     - Update [postcss.config.js](postcss.config.js) if needed
     - Check all custom theme configurations
     - Review all component styling for breaking changes
     - Test @tailwindcss/typography compatibility
     - **Consider:** May need to update @tailwindcss/vite plugin

2. **@tailwindcss/typography** (0.5.19 ‚Üí ?)
   - Check if update available for v4 compatibility

### Testing Checklist

- [ ] Visual regression testing on all pages:
  - [ ] Home page
  - [ ] Dashboard
  - [ ] Conversation View
  - [ ] Supporters page
  - [ ] Auth page
  - [ ] Demo page
- [ ] Test responsive breakpoints (mobile, tablet, desktop)
- [ ] Verify custom theme colors and spacing
- [ ] Check dark mode if implemented
- [ ] Test all UI components in [client/src/components/ui/](client/src/components/ui/)
- [ ] Verify typography in markdown rendering

### Rollback Plan

This is a critical update. Consider:

1. Creating a feature branch: `git checkout -b upgrade/tailwind-v4`
2. Committing Phase 1 & 2 updates first
3. Taking screenshots of all pages before update
4. Having full rollback capability

---

## üü† Phase 4: Form & Validation Libraries (Week 4)

**Goal:** Update form handling and validation

### Packages to Update

1. **zod** (3.25.76 ‚Üí 4.3.5)
   - Risk: High
   - Notes: Major version with breaking changes
   - **Action Items:**
     - Review [Zod v4 changelog](https://github.com/colinhacks/zod/releases)
     - Update all schema definitions in [shared/schema.ts](shared/schema.ts)
     - Test all form validations
     - Check error message formats

2. **@hookform/resolvers** (3.10.0 ‚Üí 5.2.2)
   - Risk: Medium-High
   - Notes: Must be updated AFTER zod
   - **Action Items:**
     - Ensure compatibility with Zod v4
     - Test form submissions with validation

### Files to Review

- [shared/schema.ts](shared/schema.ts) - All Zod schemas
- [client/src/components/create-update-dialog.tsx](client/src/components/create-update-dialog.tsx)
- [client/src/components/invite-supporter-dialog.tsx](client/src/components/invite-supporter-dialog.tsx)
- Any other forms using react-hook-form

### Testing Checklist

- [ ] Test all form validations:
  - [ ] Login/Signup forms
  - [ ] Create/Update dialogs
  - [ ] Invite supporter dialog
- [ ] Verify error messages display correctly
- [ ] Test edge cases (empty fields, invalid data)
- [ ] Check TypeScript types for schema inference
- [ ] Test API request/response validation

---

## üü† Phase 5: Date Handling (Week 4-5)

**Goal:** Update date manipulation library

### Packages to Update

1. **date-fns** (3.6.0 ‚Üí 4.1.0)
   - Risk: Medium-High
   - Notes: Major version may have breaking API changes
   - **Action Items:**
     - Review [date-fns v4 changelog](https://github.com/date-fns/date-fns/releases)
     - Find all date-fns imports across the project
     - Update function calls if API changed
     - Verify date formatting patterns

### Testing Checklist

- [ ] Test date display in conversations
- [ ] Verify calendar component (react-day-picker integration)
- [ ] Check timestamp formatting
- [ ] Test date sorting/filtering if implemented
- [ ] Verify timezone handling

---

## üü† Phase 6: Charts & Visualization (Week 5)

**Goal:** Update charting library

### Packages to Update

1. **recharts** (2.15.4 ‚Üí 3.6.0)
   - Risk: Medium-High
   - Notes: Major version, check component props
   - **Action Items:**
     - Review [recharts v3 migration guide](https://github.com/recharts/recharts/releases)
     - Update chart components in [client/src/components/ui/chart.tsx](client/src/components/ui/chart.tsx)
     - Test all chart implementations

### Testing Checklist

- [ ] Test all chart/graph visualizations
- [ ] Verify data binding and updates
- [ ] Check responsive behavior
- [ ] Test tooltips and interactions
- [ ] Verify accessibility features

---

## üî¥ Phase 7: Express v5 Migration (Week 6-7)

**Goal:** Migrate backend to Express v5

**‚ö†Ô∏è HIGHEST RISK - Requires significant testing**

### Packages to Update

1. **express** (4.22.1 ‚Üí 5.2.1)
2. **@types/express** (4.17.25 ‚Üí 5.0.6)

### Breaking Changes to Address

#### 1. Middleware Changes

- Middleware must be async-aware
- Error handling changes

#### 2. Response API Changes

- Some deprecated methods removed
- `res.json()` and `res.send()` behavior changes

#### 3. Router Changes

- Router API may have updates

### Action Items

1. **Review Express v5 Migration Guide**
   - [Official Express 5 Migration Guide](https://expressjs.com/en/guide/migrating-5.html)

2. **Update Server Files**
   - [server/index.ts](server/index.ts)
   - [server/routes.ts](server/routes.ts)
   - [server/static.ts](server/static.ts)
   - [server/vite.ts](server/vite.ts)

3. **Update Middleware**
   - Check express-session compatibility
   - Verify passport middleware works
   - Test multer file uploads

4. **Test All API Endpoints**
   - Authentication endpoints
   - CRUD operations
   - WebSocket connections
   - File uploads
   - Static file serving

### Testing Checklist

- [ ] **Authentication**
  - [ ] Login
  - [ ] Logout
  - [ ] Session persistence
  - [ ] Protected routes
- [ ] **API Endpoints**
  - [ ] GET requests
  - [ ] POST requests
  - [ ] PUT/PATCH requests
  - [ ] DELETE requests
  - [ ] Error responses
- [ ] **WebSocket**
  - [ ] Connection establishment
  - [ ] Real-time updates
  - [ ] Connection cleanup
- [ ] **File Operations**
  - [ ] File uploads (multer)
  - [ ] Static file serving
- [ ] **Error Handling**
  - [ ] 404 errors
  - [ ] 500 errors
  - [ ] Validation errors

### Rollback Plan

- Keep Express v4 branch
- Document all changes made
- Have database backup ready
- Test rollback procedure

---

## üìã General Guidelines

### Before Each Phase

1. **Create a backup branch**

   ```bash
   git checkout -b backup/pre-phase-N
   git push origin backup/pre-phase-N
   ```

2. **Document current state**
   - Take screenshots of critical pages
   - Note any existing bugs/issues
   - Record performance metrics if applicable

3. **Review changelogs**
   - Read release notes for each package
   - Note any breaking changes
   - Check for new features that could be useful

### During Each Phase

1. **Update packages**

   ```bash
   npm install <package>@latest
   ```

2. **Run checks immediately**

   ```bash
   npm run check        # TypeScript
   npm run build        # Production build
   npm run dev          # Development server
   ```

3. **Test incrementally**
   - Don't update multiple packages without testing
   - Fix issues as they arise
   - Commit working states

### After Each Phase

1. **Comprehensive testing**
   - Manual testing of affected features
   - Check console for warnings/errors
   - Verify production build works

2. **Commit changes**

   ```bash
   git add .
   git commit -m "Phase N: Update <packages>"
   ```

3. **Document issues**
   - Note any problems encountered
   - Document solutions applied
   - Update this plan if needed

---

## üö® Risk Mitigation

### High-Risk Updates

- **Tailwind v4**: Most visual impact
- **Express v5**: Backend stability
- **Zod v4**: Data validation critical

### Recommendations

1. **Timing**: Perform updates during low-traffic periods
2. **Staging**: Test in staging environment before production
3. **Monitoring**: Watch error logs closely after deployment
4. **Team**: Have developers available for quick fixes

### Emergency Rollback

If critical issues arise:

```bash
# Quick rollback
git reset --hard HEAD~1
npm install
npm run build

# Or restore from backup branch
git checkout backup/pre-phase-N
git checkout -b fix/rollback-phase-N
npm install
```

‚úÖ Complete | Jan 5, 2026 | Jan 5, 2026 | tailwind-merge, @types/node updated; framer-motion deferred |
| Phase 2 | ‚úÖ Complete | Jan 5, 2026 | Jan 5, 2026 | @vitejs/plugin-react, react-resizable-panels updated

## üìä Progress Tracking

| Phase   | Status         | Start Date | Complete Date | Notes            |
| ------- | -------------- | ---------- | ------------- | ---------------- |
| Phase 1 | ‚¨ú Not Started |            |               | Low-risk updates |
| Phase 2 | ‚¨ú Not Started |            |               | React ecosystem  |
| Phase 3 | ‚¨ú Not Started |            |               | Tailwind v4      |
| Phase 4 | ‚¨ú Not Started |            |               | Form validation  |
| Phase 5 | ‚¨ú Not Started |            |               | Date handling    |
| Phase 6 | ‚¨ú Not Started |            |               | Charts           |
| Phase 7 | ‚¨ú Not Started |            |               | Express v5       |

---

## üìù Notes

- **Estimated Timeline**: 6-7 weeks with careful testing
- **Can be accelerated**: Combine low-risk phases if time is critical
- **Can be slowed**: Take more time for critical updates (Tailwind, Express)
- **Parallel work**: Some phases can overlap if different developers work on them

---

## üîó Resources

- [npm-check-updates documentation](https://github.com/raineorshine/npm-check-updates)
- [Tailwind v4 Migration Guide](https://tailwindcss.com/docs/upgrade-guide)
- [Express v5 Migration Guide](https://expressjs.com/en/guide/migrating-5.html)
- [Zod GitHub Releases](https://github.com/colinhacks/zod/releases)
- [date-fns GitHub Releases](https://github.com/date-fns/date-fns/releases)

---

## ‚úÖ Final Checklist (Before Production)

- [ ] All phases completed successfully
- [ ] Full regression testing performed
- [ ] Performance benchmarks acceptable
- [ ] No console errors in production build
- [ ] Documentation updated
- [ ] Team trained on any API changes
- [ ] Monitoring/alerting configured
- [ ] Rollback plan tested
- [ ] Backup created
- [ ] Changelog updated

---

**Last Updated**: January 5, 2026
